# Release Process

## Conventional Commits

This project uses [Conventional Commits](https://www.conventionalcommits.org/) for automated versioning.

### Commit Message Format

```
<type>(<scope>): <subject>

[optional body]

[optional footer]
```

### Types

- **feat**: A new feature (triggers MINOR version bump)
- **fix**: A bug fix (triggers PATCH version bump)
- **docs**: Documentation only changes
- **style**: Code style changes (formatting, etc.)
- **refactor**: Code change that neither fixes a bug nor adds a feature
- **perf**: Performance improvements
- **test**: Adding or updating tests
- **chore**: Changes to build process or auxiliary tools

### Breaking Changes

Add `BREAKING CHANGE:` in the footer or `!` after the type to trigger a MAJOR version bump:

```
feat!: remove deprecated API

BREAKING CHANGE: The old API has been removed
```

### Examples

```bash
# New feature (0.1.0 → 0.2.0)
git commit -m "feat(dashboard): add search functionality"

# Bug fix (0.1.0 → 0.1.1)
git commit -m "fix(core): correct brotli compression calculation"

# Breaking change (0.1.0 → 1.0.0)
git commit -m "feat(core)!: redesign metrics API

BREAKING CHANGE: The collectMetrics function now returns a Promise"

# Documentation
git commit -m "docs: update installation instructions"

# Multiple packages
git commit -m "feat(vite-plugin,next-plugin): add budget warnings"
```

## How Releases Work

1. **Push to main branch** with conventional commits
2. **CI runs tests** (must pass)
3. **semantic-release analyzes commits** to determine version bump
4. **CHANGELOG.md is auto-generated**
5. **Version is bumped** in all package.json files
6. **Git tag is created**
7. **GitHub release is created**
8. *(When ready)* **Packages are published to npm**

## Manual Release (Local)

```bash
# Dry run (see what would be released)
pnpm release:dry

# Actual release (requires GH_TOKEN and NPM_TOKEN)
pnpm release
```

## Version Strategy

All packages in the monorepo share the same version number for simplicity.

- `0.x.y` - Experimental phase (current)
- `1.0.0` - First stable release
- After 1.0.0 - Semantic versioning strictly followed

## Secrets Required

For CI/CD releases, you need:

1. **GH_TOKEN** - GitHub Personal Access Token with repo access
   - Already available as `GITHUB_TOKEN` in GitHub Actions
2. **NPM_TOKEN** - npm access token for publishing
   - Add in GitHub repo settings > Secrets

## Skip CI

To skip the release process:

```bash
git commit -m "docs: update readme [skip ci]"
```

