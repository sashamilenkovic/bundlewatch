[{"data":1,"prerenderedAt":405},["ShallowReactive",2],{"content-query-aMQukRU4GJ":3},{"_path":4,"_dir":5,"_draft":6,"_partial":6,"_locale":5,"title":7,"description":8,"body":9,"_type":399,"_id":400,"_source":401,"_file":402,"_stem":403,"_extension":404},"/storage","",false,"Git Storage","How BundleWatch persists metrics in an orphan branch.",{"type":10,"children":11,"toc":394},"root",[12,21,44,51,89,98,104,272,285,291,296,383,388],{"type":13,"tag":14,"props":15,"children":17},"element","h1",{"id":16},"git-storage",[18],{"type":19,"value":20},"text","ðŸ’¾ Git Storage",{"type":13,"tag":22,"props":23,"children":24},"p",{},[25,27,34,36,42],{"type":19,"value":26},"BundleWatch avoids external databases by storing metrics JSON files inside a dedicated Git branch (default: ",{"type":13,"tag":28,"props":29,"children":31},"code",{"className":30},[],[32],{"type":19,"value":33},"bundlewatch-data",{"type":19,"value":35},"). Each CI run writes the current metrics and updates ",{"type":13,"tag":28,"props":37,"children":39},{"className":38},[],[40],{"type":19,"value":41},"latest.json",{"type":19,"value":43}," per branch. This keeps history auditable and makes comparisons trivial.",{"type":13,"tag":45,"props":46,"children":48},"h2",{"id":47},"how-it-works",[49],{"type":19,"value":50},"How it works",{"type":13,"tag":52,"props":53,"children":54},"ol",{},[55,61,74,84],{"type":13,"tag":56,"props":57,"children":58},"li",{},[59],{"type":19,"value":60},"BundleWatch collects metrics after your build (plugins or CLI).",{"type":13,"tag":56,"props":62,"children":63},{},[64,66,72],{"type":19,"value":65},"Metrics get written to ",{"type":13,"tag":28,"props":67,"children":69},{"className":68},[],[70],{"type":19,"value":71},"data/\u003Ccode-branch>/\u003Ctimestamp>-\u003Ccommit>.json",{"type":19,"value":73},".",{"type":13,"tag":56,"props":75,"children":76},{},[77,82],{"type":13,"tag":28,"props":78,"children":80},{"className":79},[],[81],{"type":19,"value":41},{"type":19,"value":83}," holds the most recent snapshot per branch for quick lookups.",{"type":13,"tag":56,"props":85,"children":86},{},[87],{"type":19,"value":88},"CI pushes the orphan branch back to origin.",{"type":13,"tag":90,"props":91,"children":93},"pre",{"code":92},".git/\nâ””â”€ bundlewatch-data\n   â””â”€ data/\n      â”œâ”€ main/\n      â”‚  â”œâ”€ 1730939472000-abc1234.json\n      â”‚  â””â”€ latest.json\n      â””â”€ feature/my-change/\n         â””â”€ ...\n",[94],{"type":13,"tag":28,"props":95,"children":96},{"__ignoreMap":5},[97],{"type":19,"value":92},{"type":13,"tag":45,"props":99,"children":101},{"id":100},"configuring-ci",[102],{"type":19,"value":103},"Configuring CI",{"type":13,"tag":90,"props":105,"children":109},{"code":106,"language":107,"meta":5,"className":108,"style":5},"permissions:\n  contents: write\n\nsteps:\n  - uses: actions/checkout@v4\n    with:\n      fetch-depth: 0\n  - run: pnpm install\n  - run: pnpm build\n","yaml","language-yaml shiki shiki-themes github-dark",[110],{"type":13,"tag":28,"props":111,"children":112},{"__ignoreMap":5},[113,131,151,161,174,197,210,229,251],{"type":13,"tag":114,"props":115,"children":118},"span",{"class":116,"line":117},"line",1,[119,125],{"type":13,"tag":114,"props":120,"children":122},{"style":121},"--shiki-default:#85E89D",[123],{"type":19,"value":124},"permissions",{"type":13,"tag":114,"props":126,"children":128},{"style":127},"--shiki-default:#E1E4E8",[129],{"type":19,"value":130},":\n",{"type":13,"tag":114,"props":132,"children":134},{"class":116,"line":133},2,[135,140,145],{"type":13,"tag":114,"props":136,"children":137},{"style":121},[138],{"type":19,"value":139},"  contents",{"type":13,"tag":114,"props":141,"children":142},{"style":127},[143],{"type":19,"value":144},": ",{"type":13,"tag":114,"props":146,"children":148},{"style":147},"--shiki-default:#9ECBFF",[149],{"type":19,"value":150},"write\n",{"type":13,"tag":114,"props":152,"children":154},{"class":116,"line":153},3,[155],{"type":13,"tag":114,"props":156,"children":158},{"emptyLinePlaceholder":157},true,[159],{"type":19,"value":160},"\n",{"type":13,"tag":114,"props":162,"children":164},{"class":116,"line":163},4,[165,170],{"type":13,"tag":114,"props":166,"children":167},{"style":121},[168],{"type":19,"value":169},"steps",{"type":13,"tag":114,"props":171,"children":172},{"style":127},[173],{"type":19,"value":130},{"type":13,"tag":114,"props":175,"children":177},{"class":116,"line":176},5,[178,183,188,192],{"type":13,"tag":114,"props":179,"children":180},{"style":127},[181],{"type":19,"value":182},"  - ",{"type":13,"tag":114,"props":184,"children":185},{"style":121},[186],{"type":19,"value":187},"uses",{"type":13,"tag":114,"props":189,"children":190},{"style":127},[191],{"type":19,"value":144},{"type":13,"tag":114,"props":193,"children":194},{"style":147},[195],{"type":19,"value":196},"actions/checkout@v4\n",{"type":13,"tag":114,"props":198,"children":200},{"class":116,"line":199},6,[201,206],{"type":13,"tag":114,"props":202,"children":203},{"style":121},[204],{"type":19,"value":205},"    with",{"type":13,"tag":114,"props":207,"children":208},{"style":127},[209],{"type":19,"value":130},{"type":13,"tag":114,"props":211,"children":213},{"class":116,"line":212},7,[214,219,223],{"type":13,"tag":114,"props":215,"children":216},{"style":121},[217],{"type":19,"value":218},"      fetch-depth",{"type":13,"tag":114,"props":220,"children":221},{"style":127},[222],{"type":19,"value":144},{"type":13,"tag":114,"props":224,"children":226},{"style":225},"--shiki-default:#79B8FF",[227],{"type":19,"value":228},"0\n",{"type":13,"tag":114,"props":230,"children":232},{"class":116,"line":231},8,[233,237,242,246],{"type":13,"tag":114,"props":234,"children":235},{"style":127},[236],{"type":19,"value":182},{"type":13,"tag":114,"props":238,"children":239},{"style":121},[240],{"type":19,"value":241},"run",{"type":13,"tag":114,"props":243,"children":244},{"style":127},[245],{"type":19,"value":144},{"type":13,"tag":114,"props":247,"children":248},{"style":147},[249],{"type":19,"value":250},"pnpm install\n",{"type":13,"tag":114,"props":252,"children":254},{"class":116,"line":253},9,[255,259,263,267],{"type":13,"tag":114,"props":256,"children":257},{"style":127},[258],{"type":19,"value":182},{"type":13,"tag":114,"props":260,"children":261},{"style":121},[262],{"type":19,"value":241},{"type":13,"tag":114,"props":264,"children":265},{"style":127},[266],{"type":19,"value":144},{"type":13,"tag":114,"props":268,"children":269},{"style":147},[270],{"type":19,"value":271},"pnpm build\n",{"type":13,"tag":22,"props":273,"children":274},{},[275,277,283],{"type":19,"value":276},"Set ",{"type":13,"tag":28,"props":278,"children":280},{"className":279},[],[281],{"type":19,"value":282},"saveToGit: true",{"type":19,"value":284}," (default in CI) on the plugin or CLI call so metrics are persisted automatically.",{"type":13,"tag":45,"props":286,"children":288},{"id":287},"switching-branches-or-remotes",[289],{"type":19,"value":290},"Switching branches or remotes",{"type":13,"tag":22,"props":292,"children":293},{},[294],{"type":19,"value":295},"All storage helpers accept overrides:",{"type":13,"tag":90,"props":297,"children":301},{"code":298,"language":299,"meta":5,"className":300,"style":5},"const storage = new GitStorage({\n  branch: 'bundlewatch-data',\n  remote: 'origin',\n});\n","ts","language-ts shiki shiki-themes github-dark",[302],{"type":13,"tag":28,"props":303,"children":304},{"__ignoreMap":5},[305,340,358,375],{"type":13,"tag":114,"props":306,"children":307},{"class":116,"line":117},[308,314,319,324,329,335],{"type":13,"tag":114,"props":309,"children":311},{"style":310},"--shiki-default:#F97583",[312],{"type":19,"value":313},"const",{"type":13,"tag":114,"props":315,"children":316},{"style":225},[317],{"type":19,"value":318}," storage",{"type":13,"tag":114,"props":320,"children":321},{"style":310},[322],{"type":19,"value":323}," =",{"type":13,"tag":114,"props":325,"children":326},{"style":310},[327],{"type":19,"value":328}," new",{"type":13,"tag":114,"props":330,"children":332},{"style":331},"--shiki-default:#B392F0",[333],{"type":19,"value":334}," GitStorage",{"type":13,"tag":114,"props":336,"children":337},{"style":127},[338],{"type":19,"value":339},"({\n",{"type":13,"tag":114,"props":341,"children":342},{"class":116,"line":133},[343,348,353],{"type":13,"tag":114,"props":344,"children":345},{"style":127},[346],{"type":19,"value":347},"  branch: ",{"type":13,"tag":114,"props":349,"children":350},{"style":147},[351],{"type":19,"value":352},"'bundlewatch-data'",{"type":13,"tag":114,"props":354,"children":355},{"style":127},[356],{"type":19,"value":357},",\n",{"type":13,"tag":114,"props":359,"children":360},{"class":116,"line":153},[361,366,371],{"type":13,"tag":114,"props":362,"children":363},{"style":127},[364],{"type":19,"value":365},"  remote: ",{"type":13,"tag":114,"props":367,"children":368},{"style":147},[369],{"type":19,"value":370},"'origin'",{"type":13,"tag":114,"props":372,"children":373},{"style":127},[374],{"type":19,"value":357},{"type":13,"tag":114,"props":376,"children":377},{"class":116,"line":163},[378],{"type":13,"tag":114,"props":379,"children":380},{"style":127},[381],{"type":19,"value":382},"});\n",{"type":13,"tag":22,"props":384,"children":385},{},[386],{"type":19,"value":387},"Keep the docs aligned with the code by updating this section whenever the storage contract changes.",{"type":13,"tag":389,"props":390,"children":391},"style",{},[392],{"type":19,"value":393},"html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}",{"title":5,"searchDepth":133,"depth":133,"links":395},[396,397,398],{"id":47,"depth":133,"text":50},{"id":100,"depth":133,"text":103},{"id":287,"depth":133,"text":290},"markdown","content:storage.md","content","storage.md","storage","md",1762641363227]