[{"data":1,"prerenderedAt":411},["ShallowReactive",2],{"content-query-wMtNnM9LkV":3},{"_path":4,"_dir":5,"_draft":6,"_partial":6,"_locale":5,"title":7,"description":8,"body":9,"_type":405,"_id":406,"_source":407,"_file":408,"_stem":409,"_extension":410},"/architecture","",false,"Architecture","Understand how parsers, plugins, storage, and dashboards fit together.",{"type":10,"children":11,"toc":397},"root",[12,21,44,51,60,150,156,161,230,259,265,283,291,296,302,326,332],{"type":13,"tag":14,"props":15,"children":17},"element","h1",{"id":16},"Ô∏è-architecture",[18],{"type":19,"value":20},"text","üèóÔ∏è Architecture",{"type":13,"tag":22,"props":23,"children":24},"p",{},[25,27,34,36,42],{"type":19,"value":26},"BundleWatch is a pnpm monorepo with small, composable packages. Everything shares the same ",{"type":13,"tag":28,"props":29,"children":31},"code",{"className":30},[],[32],{"type":19,"value":33},"BuildMetrics",{"type":19,"value":35}," type from ",{"type":13,"tag":28,"props":37,"children":39},{"className":38},[],[40],{"type":19,"value":41},"packages/core",{"type":19,"value":43},", so plugins and the CLI can swap data freely.",{"type":13,"tag":45,"props":46,"children":48},"h2",{"id":47},"package-graph",[49],{"type":19,"value":50},"Package graph",{"type":13,"tag":52,"props":53,"children":55},"pre",{"code":54},"@milencode/bundlewatch-core (types + collectors + comparison + git storage)\n        ‚Üì\n        ‚îú‚îÄ @milencode/bundlewatch-parsers    # ingest bundler outputs\n        ‚îú‚îÄ @milencode/bundlewatch-vite-plugin\n        ‚îú‚îÄ @milencode/bundlewatch-webpack-plugin\n        ‚îú‚îÄ @milencode/bundlewatch-next-plugin\n        ‚îú‚îÄ @milencode/bundlewatch-cli\n        ‚îî‚îÄ @milencode/bundlewatch-dashboard (HTML output helpers)\n",[56],{"type":13,"tag":28,"props":57,"children":58},{"__ignoreMap":5},[59],{"type":19,"value":54},{"type":13,"tag":61,"props":62,"children":63},"ul",{},[64,107,124],{"type":13,"tag":65,"props":66,"children":67},"li",{},[68,74,76,82,84,90,91,97,99,105],{"type":13,"tag":69,"props":70,"children":71},"strong",{},[72],{"type":19,"value":73},"Core",{"type":19,"value":75}," exposes ",{"type":13,"tag":28,"props":77,"children":79},{"className":78},[],[80],{"type":19,"value":81},"collectMetrics",{"type":19,"value":83},", ",{"type":13,"tag":28,"props":85,"children":87},{"className":86},[],[88],{"type":19,"value":89},"compareMetrics",{"type":19,"value":83},{"type":13,"tag":28,"props":92,"children":94},{"className":93},[],[95],{"type":19,"value":96},"GitStorage",{"type":19,"value":98},", and ",{"type":13,"tag":28,"props":100,"children":102},{"className":101},[],[103],{"type":19,"value":104},"ReportGenerator",{"type":19,"value":106},".",{"type":13,"tag":65,"props":108,"children":109},{},[110,115,117,122],{"type":13,"tag":69,"props":111,"children":112},{},[113],{"type":19,"value":114},"Parsers",{"type":19,"value":116}," convert native bundler stats (Webpack stats, Vite/Rollup bundles) to ",{"type":13,"tag":28,"props":118,"children":120},{"className":119},[],[121],{"type":19,"value":33},{"type":19,"value":123}," and also generate enhanced dashboards.",{"type":13,"tag":65,"props":125,"children":126},{},[127,132,134,140,142,148],{"type":13,"tag":69,"props":128,"children":129},{},[130],{"type":19,"value":131},"Plugins / CLI",{"type":19,"value":133}," decide ",{"type":13,"tag":135,"props":136,"children":137},"em",{},[138],{"type":19,"value":139},"when",{"type":19,"value":141}," to collect metrics (after a build, after ",{"type":13,"tag":28,"props":143,"children":145},{"className":144},[],[146],{"type":19,"value":147},"vite build",{"type":19,"value":149},", etc.) and how to persist them.",{"type":13,"tag":45,"props":151,"children":153},{"id":152},"parser-pivot",[154],{"type":19,"value":155},"Parser pivot",{"type":13,"tag":22,"props":157,"children":158},{},[159],{"type":19,"value":160},"Originally every plugin walked the output directory, recompressed assets, and guesstimated dependency graphs. The parser packages now tap into the bundler‚Äôs own metadata so the work happens in-memory:",{"type":13,"tag":162,"props":163,"children":164},"table",{},[165,189],{"type":13,"tag":166,"props":167,"children":168},"thead",{},[169],{"type":13,"tag":170,"props":171,"children":172},"tr",{},[173,179,184],{"type":13,"tag":174,"props":175,"children":176},"th",{},[177],{"type":19,"value":178},"Approach",{"type":13,"tag":174,"props":180,"children":181},{},[182],{"type":19,"value":183},"What Happens",{"type":13,"tag":174,"props":185,"children":186},{},[187],{"type":19,"value":188},"Time",{"type":13,"tag":190,"props":191,"children":192},"tbody",{},[193,212],{"type":13,"tag":170,"props":194,"children":195},{},[196,202,207],{"type":13,"tag":197,"props":198,"children":199},"td",{},[200],{"type":19,"value":201},"Legacy collector",{"type":13,"tag":197,"props":203,"children":204},{},[205],{"type":19,"value":206},"Read every file ‚Üí gzip ‚Üí brotli ‚Üí stitch metrics",{"type":13,"tag":197,"props":208,"children":209},{},[210],{"type":19,"value":211},"~2 s",{"type":13,"tag":170,"props":213,"children":214},{},[215,220,225],{"type":13,"tag":197,"props":216,"children":217},{},[218],{"type":19,"value":219},"Parser (current goal)",{"type":13,"tag":197,"props":221,"children":222},{},[223],{"type":19,"value":224},"Consume stats/bundle JSON in memory ‚Üí map to metrics",{"type":13,"tag":197,"props":226,"children":227},{},[228],{"type":19,"value":229},"~50 ms",{"type":13,"tag":22,"props":231,"children":232},{},[233,235,241,243,249,251,257],{"type":19,"value":234},"The Webpack plugin already uses ",{"type":13,"tag":28,"props":236,"children":238},{"className":237},[],[239],{"type":19,"value":240},"parseWebpackStats",{"type":19,"value":242},". The Vite plugin still relies on ",{"type":13,"tag":28,"props":244,"children":246},{"className":245},[],[247],{"type":19,"value":248},"MetricsCollector",{"type":19,"value":250}," and will switch once ",{"type":13,"tag":28,"props":252,"children":254},{"className":253},[],[255],{"type":19,"value":256},"parseViteBundle",{"type":19,"value":258}," lands.",{"type":13,"tag":45,"props":260,"children":262},{"id":261},"git-storage-layer",[263],{"type":19,"value":264},"Git storage layer",{"type":13,"tag":22,"props":266,"children":267},{},[268,273,275,281],{"type":13,"tag":28,"props":269,"children":271},{"className":270},[],[272],{"type":19,"value":96},{"type":19,"value":274}," writes metrics to an orphan branch (default ",{"type":13,"tag":28,"props":276,"children":278},{"className":277},[],[279],{"type":19,"value":280},"bundlewatch-data",{"type":19,"value":282},"). Each branch gets its own folder:",{"type":13,"tag":52,"props":284,"children":286},{"code":285},"data/\n  main/\n    1730939472000-abc1234.json\n    latest.json\n  feature/parser-refactor/\n    1731021234000-def5678.json\n",[287],{"type":13,"tag":28,"props":288,"children":289},{"__ignoreMap":5},[290],{"type":19,"value":285},{"type":13,"tag":22,"props":292,"children":293},{},[294],{"type":19,"value":295},"During CI the plugin/CLI saves the current metrics and optionally compares against another branch before logging a report or failing budgets.",{"type":13,"tag":45,"props":297,"children":299},{"id":298},"dashboards-insights",[300],{"type":19,"value":301},"Dashboards & insights",{"type":13,"tag":61,"props":303,"children":304},{},[305,316,321],{"type":13,"tag":65,"props":306,"children":307},{},[308,314],{"type":13,"tag":28,"props":309,"children":311},{"className":310},[],[312],{"type":19,"value":313},"packages/parsers/src/dashboard.ts",{"type":19,"value":315}," builds a treemap from either detailed dependency metrics or the bundle list.",{"type":13,"tag":65,"props":317,"children":318},{},[319],{"type":19,"value":320},"Webpack plugin ships an ‚Äúenhanced dashboard‚Äù (modules, dependencies, source-file stats) because the parser returns all that info.",{"type":13,"tag":65,"props":322,"children":323},{},[324],{"type":19,"value":325},"Vite/Next/CLI still render a simpler treemap until they switch to parser-derived data.",{"type":13,"tag":45,"props":327,"children":329},{"id":328},"roadmap-snapshot",[330],{"type":19,"value":331},"Roadmap snapshot",{"type":13,"tag":333,"props":334,"children":335},"ol",{},[336,377,387],{"type":13,"tag":65,"props":337,"children":338},{},[339,344,346,352,354,360,361,367,369,375],{"type":13,"tag":69,"props":340,"children":341},{},[342],{"type":19,"value":343},"Vite parser integration",{"type":19,"value":345}," ‚Äì wire ",{"type":13,"tag":28,"props":347,"children":349},{"className":348},[],[350],{"type":19,"value":351},"createAnalyzerState",{"type":19,"value":353},"/",{"type":13,"tag":28,"props":355,"children":357},{"className":356},[],[358],{"type":19,"value":359},"collectModuleInfo",{"type":19,"value":353},{"type":13,"tag":28,"props":362,"children":364},{"className":363},[],[365],{"type":19,"value":366},"analyzeBundle",{"type":19,"value":368}," into the Vite plugin‚Äôs ",{"type":13,"tag":28,"props":370,"children":372},{"className":371},[],[373],{"type":19,"value":374},"generateBundle",{"type":19,"value":376}," hook.",{"type":13,"tag":65,"props":378,"children":379},{},[380,385],{"type":13,"tag":69,"props":381,"children":382},{},[383],{"type":19,"value":384},"CLI / Next",{"type":19,"value":386}," ‚Äì let these consume parser outputs or accept pre-generated stats.",{"type":13,"tag":65,"props":388,"children":389},{},[390,395],{"type":13,"tag":69,"props":391,"children":392},{},[393],{"type":19,"value":394},"Docs",{"type":19,"value":396}," ‚Äì keep this site in sync with code changes by updating Markdown alongside Pull Requests.",{"title":5,"searchDepth":398,"depth":398,"links":399},2,[400,401,402,403,404],{"id":47,"depth":398,"text":50},{"id":152,"depth":398,"text":155},{"id":261,"depth":398,"text":264},{"id":298,"depth":398,"text":301},{"id":328,"depth":398,"text":331},"markdown","content:architecture.md","content","architecture.md","architecture","md",1762641363227]